  
  
  
      REAL*4 FUNCTION AH2PLUS(DIVTE,W)

C-----THIS SUBROUTINE CALCULATES THE BOUND-FREE AND FREE-FREE ABSORPTION
C-----COEFFICIENT AH2PLUS
C-----FOR A GIVEN TEMPERATURE TE ( DIVTE:=1/TE ) AND WAVELENGTH
C-----WLAM BY INTERPOLATION OF DATAS PROVIDED BY BOGGESS, 1959.

      REAL*8 W
      REAL*4 WLAM,WAVE(20),A(20),B(20),divte

      DATA WAVE/
     *     500.,600.,700.,800.,900.,1000.,1100.,1200.,1400.,1500.,2000.,
     *     2500.,3000.,4000.,5000.,6000.,7000.,8000.,9000.,10000./
      DATA A/
     *     -13.00,-12.34,-11.84,-11.43,-11.09,-10.80,-10.45,-10.37,
     *     -10.05,-9.946,-9.406,-9.027,-8.737,-8.335,-8.025,-7.827,
     *     -7.632,-7.494,-7.365,-7.276/ 
      DATA B/
     *     -22170.,-4552.,10236.,18322.,29585.,32388.,32640.,31871.,
     *     30262.,29674.,25879.,22506.,19822.,16052.,13464.,11592.,
     *     10193.,9097.,8204.,7480./

      WLAM = W*1.e8  ! cm -> A
      AH2PLUS = 0.
      W0 = WAVE(1)
      NW1 = 1
      IF ( ABS(WLAM - W0) .LT. .1 ) GOTO 100
      CALL INDEX1(REAL(WLAM),WAVE,20,NW1,W0)
 100  NW2 = NW1 + 1 
      DLAM = ( WLAM - WAVE(NW1) ) / ( WAVE(NW2) - WAVE(NW1) )
      AA = A(NW1) + ( A(NW2) - A(NW1) ) * DLAM
      BB = B(NW1) + ( B(NW2) - B(NW1) ) * DLAM
      AH2PLUS = 4.840E-21 * EXP( AA + BB * DIVTE ) * DIVTE
      RETURN
      END 
