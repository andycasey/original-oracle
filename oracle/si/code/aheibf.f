  
      REAL*4 FUNCTION AHEIBF(DIVTE,W) 

C-----CALCULATION OF THE ABSORPTION COEFFICIENT AHEI FOR HEI
C-----DETERMINATION OF THE ABSORPTION COEFFICIENTS ALHEI(I) FOR THE SINGLE
C-----LEVELS WITH  PRINCIPAL QUANTUM NUMBER  N = 1, 2

      REAL*8 W
      REAL*4 DIVTE,WLAM,ALHEI(5),GHE1(3,5),GHE2(2,4),WEDGE(5),EHE(5)
      DATA GHE1/
     *     -135.041,341.992,-54.430,63.240,-222.058,1.91,-17.142,
     *     47.116,0.00,2.160,-4.368,0.00,-.103,.150,0.00/
      DATA GHE2/
     *     62.19,67.60,2.9,3.5,68.87,71.47,3.3,3.6/
      DATA WEDGE/504.3,2600.1,3121.2,3421.2,3679./
      DATA EHE/.00,230060.65,239346.65,243409.28,246311.15/ 

      WLAM = W*1.e8
      WLOG = LOG(WLAM)
      DO 100  I = 5, 4, -1
         IF ( WLAM .GT. WEDGE(I) ) GO TO 120
         J = I - 3
         AL1 = GHE2(J,2) * WLOG - GHE2(J,1)
         AL2 = GHE2(J,4) * WLOG - GHE2(J,3)
         ALHEI(I) = EXP( AL1 ) + EXP( AL2 )
 100  CONTINUE
      DO I = 3, 1, -1
         IF ( WLAM .GT. WEDGE(I) ) GOTO 120
         AL = ( ( ( GHE1(I,5) * WLOG + GHE1(I,4) ) * WLOG + 
     *             GHE1(I,3) ) * WLOG + GHE1(I,2) ) * WLOG + GHE1(I,1)
         ALHEI(I) = EXP( AL ) 
      END DO
      I = 0
 120  IHE = I + 1
      AHEIBF = 0.
      DO I = IHE,5 
         AHEIBF = AHEIBF + ALHEI(I) * EXP( - EHE(I) * DIVTE )
      END DO
      RETURN
      END 
